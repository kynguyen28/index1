name: CI/CD - MockTest Lite

on:
  push:
    branches:
      - main
      - master
  pull_request:
    branches:
      - main
      - master

jobs:
  build_and_test:
    name: Build, Lint & Test
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code ğŸ“¥
        uses: actions/checkout@v4

      - name: Set up Node.js âš™ï¸
        uses: actions/setup-node@v4
        with:
          node-version: '18' # Hoáº·c phiÃªn báº£n Node.js báº¡n Ä‘ang dÃ¹ng (vÃ­ dá»¥: '20')
          cache: 'npm'

      - name: Install dependencies ğŸ“¦
        run: npm ci

      - name: Run Lint ğŸ§¹
        # Giáº£ Ä‘á»‹nh báº¡n Ä‘Ã£ cÃ³ script "lint" trong package.json
        # Náº¿u chÆ°a cÃ³, báº¡n cáº§n thÃªm nÃ³ (vÃ­ dá»¥: "lint": "eslint .")
        run: npm run lint || echo "Script 'lint' not found, skipping."

      - name: Run Tests and generate Coverage ğŸ§ª
        # Cháº¡y kiá»ƒm thá»­ vÃ  táº¡o bÃ¡o cÃ¡o pháº¡m vi (coverage)
        run: npm run test -- --coverage

      - name: Upload Coverage Artifact â¬†ï¸
        uses: actions/upload-artifact@v4
        with:
          name: test-coverage-report
          path: coverage/
          retention-days: 7
          
  # Job tÃ¡ch biá»‡t Ä‘á»ƒ Ä‘áº£m báº£o chá»‰ cháº¡y khi cáº§n thiáº¿t (vÃ­ dá»¥: táº¡o build artifact)
  # build:
  #   name: Build Application (TÃ¹y chá»n)
  #   runs-on: ubuntu-latest
  #   needs: build_and_test
  #   steps:
  #     - name: Checkout code ğŸ“¥
  #       uses: actions/checkout@v4
  #     - name: Set up Node.js âš™ï¸
  #       uses: actions/setup-node@v4
  #       with:
  #         node-version: '18'
  #         cache: 'npm'
  #     - name: Install dependencies ğŸ“¦
  #       run: npm ci
  #     - name: Run Build Script
  #       # Giáº£ sá»­ báº¡n cÃ³ má»™t lá»‡nh build nhÆ° webpack, vite, v.v.
  #       # run: npm run build
  #     - name: Upload Build Artifact ğŸ—ï¸
  #       uses: actions/upload-artifact@v4
  #       with:
  #         name: production-build
  #         path: dist/ # Thay tháº¿ báº±ng thÆ° má»¥c build thá»±c táº¿ cá»§a báº¡n
  #         retention-days: 30